

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.6.2.min.js" integrity="sha256-2krYZKh//PcchRtd+H+VyyQoZ/e3EcrkxhM8ycwASPA=" crossorigin="anonymous"></script>

<!-- Bootstrap CSS -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-F3w7mX95PdgyTmZZMECAngseQB83DfGTowi0iMjiWaeVhAn4FJkqJByhZMI3AhiU" crossorigin="anonymous">

<!-- Bootstrap Bundle with Popper -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/js/bootstrap.bundle.min.js" integrity="sha384-/bQdsTh/da6pkI1MST/rWKFNjaCP5gBSY4sEBT38Q/9RBh9AH40zEOg7Hlq2THRZ" crossorigin="anonymous"></script>

<div class="container">

  <!-- 資料處理時畫面 -->
  <div class="d-none my-5" id="show">
    <span>資料處理中....<img src="https://i.imgur.com/pm9SKUg.gif"></span>
  </div>

  <h1 class="text-center mt-3">表單名稱</h1>

  <form id="myForm" class="form-horizontal">
    <div class="form-content">
    </div>
    <input type="hidden" name="op" value="contact" id="op">
    <input type="hidden" name="callback_url" value="" id="callback_url">
    <input type="hidden" name="callback_home_url" value="" id="callback_home_url">
    <button type="submit" class="btn btn-primary w-100" id="submit">送出</button>

  </form>

</div>

<!-- javascript start-->
<script>
  $(function(){
    let url="https://script.google.com/macros/s/AKfycbzMtPPHyuWJgkN7mGgsj5n9vI3QLRSZILtI6cq_RozJRUSEnLQtfBI_IL_JX94YFosf/exec";
    let data={
      op: 'get_stru',
      ofsn: 2
    };
    let stru = [];
    $.ajax({
      url: url, // 請求資料的網址
      data: data, // 如果需要傳送資料時，則將資料設定在這裡
      method: 'GET', // 請求資料的方式(Ex:POST / GET / PUT...等)
      dataType: 'json', // 請求資料的類型(Ex:xml, json, script, or html...等)
      async: false, // 預設是true=非同步,false=同步 (true時整行可省略)
      beforeSend: function() { // 發送請求前執行的動作
        $("#show").prop("class", "my-5");
        //......
      },
      success: function(result) { // 當成功接收到資料時
        $("#show").prop("class", "d-none my-5");
        let stru = result;
      },
      error: function(error) { // 當接收資料失敗時
        $("#show").prop("class", "d-none my-5");
        console.log(error);
        //......
      }
    });
    console.log(stru);


    let form_url = window.location.href;
    //表單網址
    $('#callback_url').val(form_url);

    //首頁網址
    $('#callback_home_url').val(form_url.replace(window.location.pathname, ''));



  })
</script>
<!-- javascript end-->